<!DOCTYPE html>
<html lang="en">
<head>
<title>Battleship Game
</title>
<meta charset="UFT-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0" />
</head>
<style>
    .TileDiv{        
        width: 400px;
        display: flex;
        flex-wrap: wrap;
    }
    .tile{
        height: 38px;
        width: 38px;
        border: solid 1px darkblue;
        background-color: aqua;
    }
</style>
<body> <!--allComputerTiles to PlayTiles-->
    <h2>Computer Tiles</h2>
    <div id="CompTiles" class="TileDiv"></div>
    <div id="PlayerHits"></div>   
    <button onclick="insert(0)">1</button> 
    <button onclick="insert(1)">2</button>
    <button onclick="insert(2)">3</button>
    <button onclick="insert(3)">4</button>
    <button onclick="insert(4)">5</button>
    <button onclick="insert(5)">6</button>
    <button onclick="insert(6)">7</button>
    <button onclick="insert(7)">8</button>
    <button onclick="insert(8)">9</button>
    <button onclick="insert(9)">10</button>
    <div id="extraButtons"></div> 
    <div id="sunk">-</div>
    <div id="computerView"></div>
    <div id="PlayTiles" class="TileDiv"></div>
    <h2>Player Tiles</h2>
    <!--placeFirst,second,third,fourth,fith then start-->
    <button onclick="start()">Start</button>
    <button onclick="next()">Next</button>
    <br>
    <button onclick="move(-10)">Up</button>
    <br>
    <button onclick="move(-1)">Left</button>
    <button onclick="move(1)">Right</button>
    <br>
    <button onclick="move(10)">Down</button>
</body>
<script>
    let size = 100;
    let newbuttonsize = size-10;
    let text = new String;
    let array = [];
    let compView = [];    
    for (let i=0;i<size;i++){
        array.push(0);
    }
    let compOrder = [];
    for (let i=0;i<size;i++){
        compOrder.push(i);
    }
    let compTiles = document.getElementById("CompTiles");
    let playTiles = document.getElementById("PlayTiles");
    for (let i=0;i<size;i++){
        let tile = document.createElement('div');
        tile.classList.add('tile')
        tile.id = i;
        compTiles.append(tile);        
    }
    for (let i=0;i<size;i++){
        let tile = document.createElement('div');
        tile.classList.add('tile')
        tile.id = "C" + i;
        playTiles.append(tile);        
    }
    let extraButtons = document.getElementById("extraButtons");
    for (let i=0;i<newbuttonsize;i++){       
        let nbv = i + 11;
        let nbfv = i + 10;
        let newButton = document.createElement('button');
        newButton.innerHTML = nbv;
        newButton.id = "nB" + nbv;        
        newButton.onclick = function (){            
            insert(nbfv);
        }
        extraButtons.append(newButton);   
        if ((i+1)%10 == 0){
        let newLine = document.createElement("br");
        extraButtons.append(newLine);}
    }
    let startS = 0;

    let pdes1 = 5;
    let pdes2 = pdes1+1;
    let pcar1 = 0;
    let pcar2 = 1;
    let pcar3 = 2;
    let pcar4 = 3;
    let pcar5 = 4;

    document.getElementById(`C${pcar1}`).style.backgroundColor = "orange";
    document.getElementById(`C${pcar2}`).style.backgroundColor = "orange";
    document.getElementById(`C${pcar3}`).style.backgroundColor = "orange";
    document.getElementById(`C${pcar4}`).style.backgroundColor = "orange";
    document.getElementById(`C${pcar5}`).style.backgroundColor = "orange";    

    function move(num){
        if (shipNum == 5){
            if ((pcar1 + num)<=-1 || (pcar1+num-5)>=(size-1) || startS>0){
            return;
            }
            document.getElementById(`C${pcar1}`).style.backgroundColor = "aqua";
            document.getElementById(`C${pcar2}`).style.backgroundColor = "aqua";
            document.getElementById(`C${pcar3}`).style.backgroundColor = "aqua";
            document.getElementById(`C${pcar4}`).style.backgroundColor = "aqua";
            document.getElementById(`C${pcar5}`).style.backgroundColor = "aqua";
        
            pcar1 += num;
            pcar2 = pcar1 + 1;
            pcar3 = pcar2 +1;
            pcar4 = pcar3 +1;
            pcar5 = pcar4 + 1;
        
            document.getElementById(`C${pcar1}`).style.backgroundColor = "orange";
            document.getElementById(`C${pcar2}`).style.backgroundColor = "orange";
            document.getElementById(`C${pcar3}`).style.backgroundColor = "orange";
            document.getElementById(`C${pcar4}`).style.backgroundColor = "orange";
            document.getElementById(`C${pcar5}`).style.backgroundColor = "orange";
            }
        
        if (shipNum == 1){
            if((pdes1 + num)<=-1 || (pdes1+num)>=(size-1) || startS>0){
            return;
        }
        document.getElementById(`C${pdes1}`).style.backgroundColor = "aqua";
        document.getElementById(`C${pdes2}`).style.backgroundColor = "aqua";
    
        pdes1 += num;
        pdes2 = pdes1 + 1;
    
        document.getElementById(`C${pdes1}`).style.backgroundColor = "orange";
        document.getElementById(`C${pdes2}`).style.backgroundColor = "orange";
       // console.log(pdes1)
       // console.log(pdes2)
    }
}
    text = array;
    compView = array.slice(0);
    let randomTarget = compOrder.slice(0);

    var shuffle = function (array) {

        var currentIndex = array.length;
        var temporaryValue, randomIndex;

        // While there remain elements to shuffle...
        while (0 !== currentIndex) {
            // Pick a remaining element...
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex -= 1;
            // And swap it with the current element.
            temporaryValue = array[currentIndex];
            array[currentIndex] = array[randomIndex];
            array[randomIndex] = temporaryValue;
        }
        //console.log(array);
        };
    
    let shipNum = 5;

    function next(){
        if(shipNum == 0){
            return;
        }
        shipNum -= 1;
        if(shipNum ==1){
            document.getElementById(`C${pdes1}`).style.backgroundColor = "orange";
            document.getElementById(`C${pdes2}`).style.backgroundColor = "orange";
        }
        console.log(shipNum);
    }

    function start(){ //only start if no ships overlap and all five ships are placed
            if(startS!==1 && shipNum == 1){
            startS = 1;
            }
        console.log(startS);
        }
    
    let fired = [];

    function insert(num){
        if(startS !== 1){
            return;
        }
               

        if(fired.length>1){
        for(let i=0;i<fired.length;i++){
            if(fired[i]==num){
                return;
            }
        }
        }

        fired.push(num);

       // console.log(fired);
        //randomised both computer and human targets
        let targets = randomTarget.slice(0,1);
        let cs1 = targets[0];
        let cs2 = cs1 + 1;
        //let ps1 = targets[2];
        //let ps2 = targets[3];
        //console.log(targets);

       // document.getElementById(`C${ps1}`).style.backgroundColor = "orange";
       // document.getElementById(`C${ps2}`).style.backgroundColor = "orange";

        //if(num != true){
           // return;
       // }
        
        let draw = 0;
        text[num] = 1;    
        document.getElementById("PlayerHits").innerHTML = text;

        document.getElementById(`${num}`).style.backgroundColor = "grey";

        let random = compOrder[0];
        compView[random] = 1;
        document.getElementById("computerView").innerHTML = compView;
        compOrder.shift();

        document.getElementById(`C${random}`).style.backgroundColor = "grey";
        //alerts player the computer is close to victory
        if(compView[pdes1] == 1 || compView[pdes2] == 1){ //add pcar to all pdes conditions to 263
            document.getElementById("sunk").innerHTML = "uh-oh";
            if(compView[pdes1] == 1){
                document.getElementById(`C${pdes1}`).style.backgroundColor = "red";
            }
            if(compView[pdes2] == 1){
                document.getElementById(`C${pdes2}`).style.backgroundColor = "red";
            }
        }

        if(text[cs1] == 1){ //cs means computers ship which gets hit
            document.getElementById(`${cs1}`).style.backgroundColor = "red";
        }

        if(text[cs2] == 1){
            document.getElementById(`${cs2}`).style.backgroundColor = "red";
        }

        if(text[cs1] == 1 && text[cs2] == 1){
            document.getElementById("sunk").innerHTML = "Comp got sunk";
            draw = draw + 1;
        }

        if(compView[pdes1] == 1 && compView[pdes2] == 1){ //ps is player ship which gets hit by computer
            document.getElementById("sunk").innerHTML = "You got sunk";
            draw = draw + 1;
        }
        //if there is draw, no winner is declared
        if(draw == 2){
            document.getElementById("sunk").innerHTML = "No Winner";
        }
    }
    /*
    Allow selection of divs to place items on
    carrier 5, battleship 4, cruiser 3, submarine 3, destroyer 2
    Click divs to destroy/hit DONE
    Make computer choose divs to hit DONE
    have total destruction equal win DONE

    L240-263 add cruiser to conditions
    change playership values to array
    add rotated option to placements
    add all ships to computer ships
    add all computer ships to player victory conditions
    only start if no ships overlap and all five ships are placed
    */
    document.getElementById("PlayerHits").innerHTML = text;
    document.getElementById("computerView").innerHTML = text;    
    shuffle(compOrder);
    shuffle(randomTarget);

    console.log(randomTarget);

</script>
</html>